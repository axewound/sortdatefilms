
Сделал вроде всё правильно, и всё функционирует
ссылка на развернутую версию